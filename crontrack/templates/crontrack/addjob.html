{% extends 'crontrack/base.html' %}

{% block title %} Add a new job {% endblock %}

{% block content %}
	<div class="hcenter">
		<h2>Add a new job</h2>
		{% if user.is_authenticated %}
			<form action="{% url 'crontrack:add_job' %}" method="post">
				{% csrf_token %}
				<table class="form">
					<tr>
						<td><label for="name">Job name</label></td>
						<td><input type="text" name="name" id="name" value="{{ prefill.name }}"></td>
					</tr>
					<tr>
						<td><label for="schedule_str">Cron schedule string</label></td>
						<td><input type="text" name="schedule_str" id="schedule_str" value="{{ prefill.schedule_str }}"></td>
					</tr>
					<tr>
						<td><label for="time_window">Time window (minutes)</label></td>
						<td><input type="number" name="time_window" id="time_window" value="{{ prefill.time_window }}"></td>
					</tr>
					<tr>
						<td><label for="description">Description (optional)</label></td>
						<td><textarea name="description" id="description" maxlength="200" value="{{ prefill.description }}"></textarea></td>
						<!-- TODO: should really define maxlength this as a constant somewhere -->
					<tfoot>
						<tr>
							<td><label>Your timezone: [TODO]</label></td>
							<td><input type="submit" value="Add job"></td>
						</tr>
					</tfoot>
				</table>
				{% if error_message %}
					<br><p class="errorMessage">Error: {{ error_message }}.</p>
				{% endif %}
				{% if success_message %}
					<br><p class="successMessage">{{ success_message }}</p> <!--- TODO: remove? -->
				{% endif %}
			</form>
		{% else %}
			<p>You are not logged in.</p>
			<a href="{% url 'crontrack:login' %}">Log in</a>
		{% endif %}
	</div>
{% endblock %}